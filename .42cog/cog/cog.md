# 认知模型 (Cog)

> LearnHub 项目的认知模型定义

## 核心实体

<cog>
本系统包括以下关键实体：
- user：用户
  - individual：个人用户，直接购买和学习
  - employee：企业员工，通过企业账户学习
  - org_admin：企业管理员，管理企业账户和员工
  - admin：平台管理员，管理整个平台
- organization：企业/组织，B端客户主体
- product：商品（抽象父类）
  - course：在线课程
  - membership：会员订阅
  - resource：数字资源
- order：订单
- license：授权，记录用户对商品的访问权限
</cog>

## 实体详情

<user>
- 唯一编码：用户ID（UUID）
- 常见分类：个人用户；企业员工；企业管理员；平台管理员
- 核心属性：邮箱、手机号、昵称、头像、注册时间
</user>

<organization>
- 唯一编码：企业ID（UUID）
- 常见分类：试用企业；付费企业；VIP企业
- 核心属性：企业名称、联系人、员工上限、订阅状态
</organization>

<course>
- 唯一编码：课程slug（如 python-intro）
- 常见分类：免费课程；付费课程；会员专享课程
- 核心属性：标题、描述、封面图、价格、章节列表、讲师
</course>

<membership>
- 唯一编码：会员类型code（如 monthly、yearly）
- 常见分类：月度会员；季度会员；年度会员；企业会员
- 核心属性：名称、价格、有效天数、权益列表
</membership>

<resource>
- 唯一编码：资源ID（UUID）
- 常见分类：电子书；模板；素材包；工具
- 核心属性：标题、描述、封面图、价格、文件地址、文件大小
</resource>

<order>
- 唯一编码：订单号（日期+随机数，如 20250130-ABC123）
- 常见分类：待支付；已支付；已取消；已退款
- 核心属性：用户ID、商品列表、总金额、支付方式、支付时间
</order>

<license>
- 唯一编码：授权ID（UUID）
- 常见分类：个人授权；企业授权；试用授权
- 核心属性：用户ID、商品ID、授权类型、开始时间、过期时间
</license>

## 实体关系

<rel>
- user-organization：多对一（多个员工属于一个企业）
- user-order：一对多（一个用户可创建多个订单）
- order-product：多对多（一个订单可包含多个商品）
- user-license：一对多（一个用户可拥有多个授权）
- license-product：多对一（一个授权对应一个商品）
- organization-license：一对多（企业可拥有多个团体授权）
</rel>

## 关系图

```
                    ┌──────────────┐
                    │ organization │
                    │   (企业)      │
                    └──────┬───────┘
                           │ 拥有员工
                           ▼
┌────────┐  创建   ┌───────────────┐  拥有   ┌─────────┐
│  user  │────────▶│     order     │◀────────│ license │
│ (用户) │         │    (订单)      │         │ (授权)   │
└────────┘         └───────┬───────┘         └────┬────┘
     │                     │ 包含                  │ 对应
     │                     ▼                      ▼
     │              ┌──────────────┐        ┌──────────┐
     └─────────────▶│   product    │◀───────│ license  │
       拥有授权      │   (商品)      │        └──────────┘
                    └──────┬───────┘
           ┌───────────────┼───────────────┐
           ▼               ▼               ▼
    ┌──────────┐    ┌────────────┐   ┌──────────┐
    │  course  │    │ membership │   │ resource │
    │  (课程)   │    │  (会员)     │   │  (资源)   │
    └──────────┘    └────────────┘   └──────────┘
```

## 业务规则补充

1. **用户注册**：个人用户可直接注册；企业员工需通过企业邀请链接注册
2. **购买流程**：用户下单 → 支付 → 创建授权 → 访问内容
3. **授权规则**：
   - 单次购买商品：永久授权
   - 会员订阅：按订阅周期授权，到期需续费
   - 企业授权：可分配给多名员工使用
4. **权限继承**：会员用户自动获得会员专享内容的访问权限
